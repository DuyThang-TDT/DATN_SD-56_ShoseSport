<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ShoesSport - Shop Giày Thể Thao</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

    @RenderSection("Styles", required: false)

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        .gradient-animated {
            background: linear-gradient(-45deg, #111827, #1f2933, #374151, #000000);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
        }

        @@keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
        }

        .text-gradient {
            background: linear-gradient(135deg, #111827, #4b5563);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>

<body class="bg-gray-100 pt-16 overflow-x-hidden">

    @inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
    @{
        var hoTen = HttpContextAccessor.HttpContext?.Session.GetString("HoTen");
        var taiKhoanId = HttpContextAccessor.HttpContext?.Session.GetString("TaiKhoanId");
        var role = HttpContextAccessor.HttpContext?.Session.GetString("Role") ?? "";

        bool isAdmin = role.ToLower().Contains("admin");
        bool isEmployee = role.ToLower().Contains("nhanvien");
    }

    <!-- ===== HEADER ===== -->
    <header class="fixed top-0 left-0 w-full glass z-50 shadow">
        <div class="container mx-auto px-4">
            <nav class="flex items-center justify-between h-16">

                <!-- LOGO -->
                <a asp-controller="Home" asp-action="Index"
                   class="text-2xl font-extrabold flex items-center gap-2 hover:scale-105 transition">
                    <i class="fa-solid fa-shoe-prints text-gray-900 text-2xl"></i>
                    <span class="text-gradient">ShoesSport</span>
                </a>

                <!-- MENU DESKTOP -->
                <ul class="hidden md:flex space-x-8 font-medium">
                    <li><a asp-controller="Home" asp-action="Index" class="hover:text-black">Trang chủ</a></li>
                    <li><a asp-controller="SanPhamKhachHang" asp-action="Index" class="hover:text-black">Giày</a></li>
                    <li><a asp-controller="TraCuuDonHang" asp-action="Index" class="hover:text-black">Tra cứu đơn</a></li>
                    <li><a asp-controller="Home" asp-action="About" class="hover:text-black">Giới thiệu</a></li>
                    <li><a asp-controller="Home" asp-action="Contact" class="hover:text-black">Liên hệ</a></li>
                </ul>

                <!-- ACTION -->
                <div class="hidden md:flex items-center gap-4">
                    @if (!string.IsNullOrEmpty(taiKhoanId))
                    {
                        <div class="relative" id="userMenuContainer">
                            <button onclick="toggleUserMenu()" class="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full hover:shadow-lg transition-all duration-300">
                                <i class="fa-regular fa-circle-user text-lg"></i>
                                <span class="font-medium max-w-[150px] truncate">@hoTen</span>
                                <i class="fa-solid fa-chevron-down text-xs transition-transform duration-300" id="userMenuArrow"></i>
                            </button>

                            <!-- Dropdown Menu -->
                            <div id="userDropdown" class="hidden absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden transform origin-top-right transition-all duration-200 z-50">
                                <div class="p-4 border-b border-gray-100 bg-gray-50">
                                    <p class="text-sm text-gray-500">Xin chào,</p>
                                    <p class="font-bold text-gray-800 truncate">@hoTen</p>
                                </div>
                                <div class="py-2">
                                    <a asp-controller="ThongTinCaNhan" asp-action="Index" class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors">
                                        <i class="fa-regular fa-id-card w-5 text-center"></i>
                                        <span>Thông tin tài khoản</span>
                                    </a>
                                    <a asp-controller="DonHang" asp-action="Index" class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors">
                                        <i class="fa-solid fa-bag-shopping w-5 text-center"></i>
                                        <span>Quản lý đơn hàng</span>
                                    </a>
                                    
                                    @if (isAdmin || isEmployee)
                                    {
                                        <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors">
                                            <i class="fa-solid fa-gauge-high w-5 text-center"></i>
                                            <span>Trang quản trị</span>
                                        </a>
                                    }
                                </div>
                                <div class="border-t border-gray-100">
                                    <form asp-controller="KhachHangLogin" asp-action="Logout" method="get">
                                        <button type="submit" class="w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 transition-colors text-left">
                                            <i class="fa-solid fa-right-from-bracket w-5 text-center"></i>
                                            <span>Đăng xuất</span>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <script>
                            function toggleUserMenu() {
                                const menu = document.getElementById('userDropdown');
                                const arrow = document.getElementById('userMenuArrow');
                                menu.classList.toggle('hidden');
                                arrow.classList.toggle('rotate-180');
                            }

                            // Close on click outside
                            window.addEventListener('click', function(e) {
                                const container = document.getElementById('userMenuContainer');
                                if (container && !container.contains(e.target)) {
                                    document.getElementById('userDropdown').classList.add('hidden');
                                    document.getElementById('userMenuArrow').classList.remove('rotate-180');
                                }
                            });
                        </script>
                    }
                    else
                    {
                        <a href="/KhachHangLogin/DangNhap"
                           class="px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-black">
                            Đăng nhập
                        </a>
                    }
                    
                    <a asp-controller="GioHangs" asp-action="Index"
                       class="relative px-4 py-2 bg-black text-white rounded-lg">
                        <i class="fa-solid fa-cart-shopping"></i>
                        <span class="absolute -top-2 -right-2 bg-red-600 text-xs rounded-full px-2">0</span>
                    </a>
                </div>

            </nav>
        </div>
    </header>

    <!-- ===== BODY ===== -->
    <main class="container mx-auto px-4 mt-6">
        @RenderBody()
    </main>

    <!-- ===== FOOTER ===== -->
    <footer class="mt-12 bg-black text-gray-300 py-6">
        <div class="text-center text-sm">
            <p class="font-semibold">ShoesSport – Shop Giày Thể Thao Chính Hãng</p>
            <p>© 2026 ShoesSport. Designed by Nguyễn Duy Anh</p>
        </div>
    </footer>

    @RenderSection("Scripts", required: false)
</body>
</html>
